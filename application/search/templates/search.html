<html>

<head>
    <title>Search structure</title>
    <script type="text/javascript" language="javascript" src="{{ url_for('search_bp.static', filename='jsme/jsme.nocache.js') }}"></script>
    <script type="text/javascript" language="javascript" src="{{ url_for('search_bp.static', filename='js/search.js') }}"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
    <link rel="stylesheet" type="text/css" href="{{ url_for('search_bp.static', filename='style.css') }}">
    <style>
        em {
            background-color: rgb(102, 255, 255);
        }

    </style>

    <script>

        //this function will be called after the JavaScriptApplet code has been loaded.
        function jsmeOnLoad() {

            jsmeApplet = new JSApplet.JSME("jsme_container", "600px", "440px", {
                "options": "newlook,query,hydrogens",
                "guicolor": "#bfbfbf",
            });

            jsmeApplet.setAfterStructureModifiedCallback(showEvent);

            document.getElementById("log").value = "";
        }

        var patt = /\[([A-Za-z][a-z]?)H?\d*:\d+\]/g; //regexp pattern for numbered atom
        function showEvent(event) {

            let log = document.getElementById("log");
            log.value = event.src.smiles();

        }

        function showValue(value) {
            document.getElementById("mol_weight_range").innerText = value;
        }

    </script>
</head>

<body onload="onExtendTable()">
<H3>Web Project (in progress)</H3>

<table>
    <tr>
        <td style="vertical-align: baseline;">
        <table id="jsme_table">
            <tr>
                <td rowspan="13">
                    <p>
                        Draw a structure or enter SMILES:
                    </p>
                    <input type="text" id="log" placeholder="SMILES" style="margin-bottom: 1%; width: 600px">
                    <p>
                        Specify molecular weight:
                    </p>
                    <div>
                        <span style="vertical-align: super;">0 Da</span>

                        <input type="range" min="0" max="10000" step="10" id="mol_weight_range" value="0"
                            oninput="document.getElementById('mol_weight_value').innerText=value" style="width: 300px;">

                        <span style="vertical-align: super;">10 kDa</span></br>
                        Minumum molecular weight:
                        <span id='mol_weight_value'>0</span>
                    </div>
                    <input type='button' value="Search" onclick="onSearch(0)" style="margin-bottom: 2%; margin-top: 1%;">
                    <div id="jsme_container"></div>
                </td>
            </tr>
        </table>
        </td>
        <td style="vertical-align: top;">
        <table id="main_table">
            <tr>
                <td colspan="7">
                    <b>
                        Structures was found:
                        <span id='result'></span>
                    </b>
                </td>
            </tr>
            <tr>
                <th>ID</th>
                <th>ChEMBL ID</th>
                <th>Molecular Weight</th>
                <th>Molecular Species</th>
                <th>Molecular Formula</th>
            </tr>
        </table>
        <div style="text-align: center;">
            <button id="prev_page" onclick="onSearch(-1)" disabled><<</button>
            <span id='page'>1</span>
            <button id="next_page" onclick="onSearch(1)" disabled>>></button>
        </div>
        </td>
    </tr>
</table>

</body>
</html>

